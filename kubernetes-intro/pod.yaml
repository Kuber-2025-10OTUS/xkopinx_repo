apiVersion: v1
kind: Pod
metadata:
  name: homework-pod
  namespace: homework
spec:
  volumes:
    - name: shared-volume
      emptyDir: {}
  initContainers:
    - name: init-container
      image: busybox:latest
      command: ['sh', '-c']
      args:
        - |
          echo '<!DOCTYPE html>
          <html>
          <head>
            <title>Homework</title>
          </head>
          <body>
            <h1>Welcome to Homework</h1>
            <p>This is a test page generated by init container.</p>
          </body>
          </html>' > /init/index.html
          echo "Init container: index.html created in /init"
      volumeMounts:
        - name: shared-volume
          mountPath: /init
  containers:
    - name: web-server
      image: python:3.9-slim
      command: ['sh', '-c']
      args:
        - |
          cd /homework
          python3 -m http.server 8000
      ports:
        - containerPort: 8000
          name: http
      volumeMounts:
        - name: shared-volume
          mountPath: /homework
      lifecycle:
        preStop:
          exec:
            command: ['sh', '-c', 'rm -f /homework/index.html && echo "index.html has been deleted from /homework"']
